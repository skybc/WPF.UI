<!--
    Default style for GrowlControl.
-->
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Wpf.Ui.Controls">

    <Style TargetType="{x:Type controls:GrowlControl}">
        <Setter Property="HorizontalAlignment" Value="Right" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="Margin" Value="16" />
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Vertical" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:GrowlControl}">
                    <Border Background="Transparent">
                        <ScrollViewer
                            CanContentScroll="True"
                            HorizontalScrollBarVisibility="Disabled"
                            VerticalScrollBarVisibility="Disabled">
                            <ItemsPresenter />
                        </ScrollViewer>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemTemplate">
            <Setter.Value>
                <DataTemplate DataType="{x:Type controls:GrowlItem}">
                    <Border
                        x:Name="Root"
                        Margin="0,0,0,12"
                        Padding="12"
                        Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource ControlStrongStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        SnapsToDevicePixels="True">
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="20"
                                Opacity="0.25"
                                ShadowDepth="4"
                                Color="#22000000" />
                        </Border.Effect>
                        <Border.RenderTransform>
                            <TranslateTransform Y="-6" />
                        </Border.RenderTransform>
                        <Border.Style>
                            <Style TargetType="Border">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsCompact, RelativeSource={RelativeSource AncestorType={x:Type controls:GrowlControl}}}" Value="True">
                                        <Setter Property="Padding" Value="8" />
                                        <Setter Property="Margin" Value="0,0,0,8" />
                                        <Setter Property="Effect">
                                            <Setter.Value>
                                                <DropShadowEffect
                                                    BlurRadius="12"
                                                    Opacity="0.18"
                                                    ShadowDepth="2"
                                                    Color="#22000000" />
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="4" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!--  左侧类型色条  -->
                            <Border Grid.Column="0" CornerRadius="4,0,0,4">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="{DynamicResource SystemAccentColorSecondaryBrush}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Info}">
                                                <Setter Property="Background" Value="{DynamicResource PaletteLightBlueBrush}" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Success}">
                                                <Setter Property="Background" Value="{DynamicResource PaletteGreenBrush}" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Warning}">
                                                <Setter Property="Background" Value="{DynamicResource PaletteOrangeBrush}" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Error}">
                                                <Setter Property="Background" Value="{DynamicResource PaletteRedBrush}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                            </Border>

                            <!--  左侧图标  -->
                            <ContentPresenter
                                Grid.Column="1"
                                Margin="10,0,10,0"
                                VerticalAlignment="Center">
                                <ContentPresenter.Content>
                                    <controls:SymbolIcon Foreground="{DynamicResource SystemAccentColorSecondaryBrush}">
                                        <controls:SymbolIcon.Style>

                                            <Style TargetType="controls:SymbolIcon">
                                                <Setter Property="Height" Value="24" />
                                                <Setter Property="Width" Value="24" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Info}">
                                                        <Setter Property="Foreground" Value="{DynamicResource PaletteLightBlueBrush}" />
                                                        <Setter Property="Symbol" Value="Info24" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Success}">
                                                        <Setter Property="Foreground" Value="{DynamicResource PaletteGreenBrush}" />
                                                        <Setter Property="Symbol" Value="CheckmarkCircle24" />
                                                    </DataTrigger>
                                                    <!--  Warning uses "Warning24" which is a triangle with an exclamation mark  -->
                                                    <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Warning}">
                                                        <Setter Property="Foreground" Value="{DynamicResource PaletteOrangeBrush}" />
                                                        <Setter Property="Symbol" Value="Warning24" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Type}" Value="{x:Static controls:GrowlType.Error}">
                                                        <Setter Property="Foreground" Value="{DynamicResource PaletteRedBrush}" />
                                                        <Setter Property="Symbol" Value="DismissCircle24" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </controls:SymbolIcon.Style>
                                    </controls:SymbolIcon>
                                </ContentPresenter.Content>

                            </ContentPresenter>

                            <!--  文本区域：Title + Message  -->
                            <StackPanel Grid.Column="2" Orientation="Vertical">
                                <TextBlock
                                    x:Name="TitleBlock"
                                    FontWeight="SemiBold"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{Binding Title}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Title.Length, TargetNullValue=0}" Value="0">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                                <TextBlock
                                    Margin="0,2,0,0"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{Binding Message}"
                                    TextWrapping="Wrap" />
                            </StackPanel>

                            <!--  关闭按钮  -->
                            <controls:Button
                                Grid.Column="3"
                                Margin="12,0,0,0"
                                Padding="6,2"
                                Command="{Binding RelativeSource={RelativeSource AncestorType={x:Type controls:GrowlControl}}, Path=CloseItemCommand}"
                                CommandParameter="{Binding}"
                                ToolTip="Close">
                                <controls:Button.Icon>
                                    <controls:SymbolIcon Symbol="Dismiss48" />
                                </controls:Button.Icon>
                            </controls:Button>
                        </Grid>

                        <!--  进入动画：淡入 + 轻微下滑 / 退出动画由代码触发  -->
                        <Border.Triggers>
                            <EventTrigger RoutedEvent="Loaded">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                                            Storyboard.TargetProperty="Opacity"
                                            From="0"
                                            To="1"
                                            Duration="0:0:0.18" />
                                        <DoubleAnimation
                                            Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                                            From="-6"
                                            To="0"
                                            Duration="0:0:0.18" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Border.Triggers>
                    </Border>
                </DataTemplate>
            </Setter.Value>
        </Setter>

        <!--  紧凑模式下的样式微调  -->
        <Style.Triggers>
            <Trigger Property="IsCompact" Value="True">
                <Setter Property="ItemContainerStyle">
                    <Setter.Value>
                        <Style TargetType="ContentPresenter">
                            <Setter Property="Margin" Value="0,0,0,8" />
                        </Style>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
